FROM golang:1.23-alpine AS baseauth

RUN apk update && apk upgrade && \
    apk add --no-cache bash git openssh

WORKDIR /app


COPY go.mod ./
RUN go mod download
RUN go get -u github.com/go-sql-driver/mysql
RUN go get github.com/gorilla/mux

COPY . .

RUN go mod tidy

FROM  baseauth
RUN go build  -mod=mod -o main ./cmd/auth/main.go



EXPOSE 8081

CMD ["./main"]
